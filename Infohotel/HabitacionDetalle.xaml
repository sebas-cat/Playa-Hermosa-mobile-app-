<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Infohotel.HabitacionDetalle"
             Title="HabitacionDetalle">
    <!-- Grid raíz: capa normal + capa popup -->
    <Grid>
        <!-- CAPA 1: contenido normal de la pantalla -->
        <ScrollView>
            <VerticalStackLayout Padding="16" Spacing="16">

                <Label x:Name="RoomNameHeader"
                       FontSize="22"
                       FontAttributes="Bold"
                       TextColor="#735945" />

                <Frame Padding="0"
                       CornerRadius="12"
                       HasShadow="True"
                       BackgroundColor="White">
                    <Image x:Name="RoomImage"
                           Aspect="AspectFill"
                           HeightRequest="200" />
                </Frame>

                <Frame Padding="12"
                       CornerRadius="12"
                       BackgroundColor="White"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Descripción"
                               FontAttributes="Bold"
                               TextColor="#735945" />
                        <Label x:Name="RoomDescription"
                               TextColor="#333333" />

                        <Label x:Name="RoomPrice"
                               Margin="0,8,0,0"
                               FontAttributes="Bold"
                               TextColor="#735945" />

                        <Label x:Name="RoomCapacity"
                               FontSize="12"
                               TextColor="#333333" />
                    </VerticalStackLayout>
                </Frame>

                <!-- “Menú” de reservaciones -->
                <Frame Padding="12"
                       CornerRadius="12"
                       BackgroundColor="White"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="10">

                        <Label Text="Disponibilidad"
                               FontAttributes="Bold"
                               TextColor="#735945" />

                        <!-- Campos de fecha con botón propio -->
                        <Grid ColumnDefinitions="*,*"
                              ColumnSpacing="10">
                            <VerticalStackLayout Grid.Column="0">
                                <Label Text="Fecha de entrada"
                                       FontSize="12"
                                       TextColor="#333333" />
                                <Button x:Name="CheckInButton"
                                        Text="Seleccionar fecha"
                                        BackgroundColor="White"
                                        TextColor="#735945"
                                        BorderColor="#735945"
                                        BorderWidth="1"
                                        CornerRadius="8"
                                        Clicked="OnSelectCheckInClicked"/>
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="1">
                                <Label Text="Fecha de salida"
                                       FontSize="12"
                                       TextColor="#333333" />
                                <Button x:Name="CheckOutButton"
                                        Text="Seleccionar fecha"
                                        BackgroundColor="White"
                                        TextColor="#735945"
                                        BorderColor="#735945"
                                        BorderWidth="1"
                                        CornerRadius="8"
                                        Clicked="OnSelectCheckOutClicked"/>
                            </VerticalStackLayout>
                        </Grid>

                        <VerticalStackLayout>
                            <Label Text="Número de personas"
                                   FontSize="12"
                                   TextColor="#333333" />
                            <Stepper x:Name="GuestsStepper"
                                     Minimum="1"
                                     Maximum="6"
                                     Increment="1"
                                     Value="2"
                                     ValueChanged="OnGuestsChanged" />
                            <Label x:Name="GuestsLabel"
                                   FontSize="12"
                                   TextColor="#333333"
                                   Text="2 personas" />
                        </VerticalStackLayout>

                    </VerticalStackLayout>
                </Frame>

                <Button Text="Reservar"
                        BackgroundColor="#735945"
                        TextColor="White"
                        CornerRadius="12"
                        HeightRequest="50"
                        Clicked="OnReservarClicked" />

            </VerticalStackLayout>
        </ScrollView>

        <!-- CAPA 2: Popup personalizado para seleccionar fecha -->
        <Grid x:Name="DatePopup"
              IsVisible="False"
              BackgroundColor="#80000000">

            <Frame BackgroundColor="White"
                   CornerRadius="16"
                   HasShadow="True"
                   Padding="16"
                   VerticalOptions="Center"
                   HorizontalOptions="Center"
                   WidthRequest="320">

                <VerticalStackLayout Spacing="12">
                    <!-- Título cambia según si es entrada o salida -->
                    <Label x:Name="DatePopupTitle"
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           TextColor="#735945" />

                    <!-- Selectores de año, mes y día -->
                    <Grid ColumnDefinitions="*,*"
                          ColumnSpacing="8">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Año" FontSize="12" />
                            <Picker x:Name="YearPicker" />
                        </VerticalStackLayout>

                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="Mes" FontSize="12" />
                            <Picker x:Name="MonthPicker"
                                    SelectedIndexChanged="OnMonthOrYearChanged" />
                        </VerticalStackLayout>
                    </Grid>

                    <VerticalStackLayout>
                        <Label Text="Día" FontSize="12" />
                        <Picker x:Name="DayPicker" />
                    </VerticalStackLayout>

                    <!-- Botones del popup -->
                    <Grid ColumnDefinitions="*,*"
                          ColumnSpacing="10"
                          Margin="0,10,0,0">
                        <Button Text="Cancelar"
                                Grid.Column="0"
                                BackgroundColor="Transparent"
                                TextColor="#735945"
                                BorderColor="#735945"
                                BorderWidth="1"
                                CornerRadius="10"
                                Clicked="OnDatePopupCancelClicked"/>

                        <Button Text="Aceptar"
                                Grid.Column="1"
                                BackgroundColor="#735945"
                                TextColor="White"
                                CornerRadius="10"
                                Clicked="OnDatePopupOkClicked"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>
        </Grid>
    </Grid>
</ContentPage>